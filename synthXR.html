<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Synth XR - Advanced Web Synthesizer</title>

    <link rel="apple-touch-icon" sizes="180x180" href="./icons/apple-touch-icon.png">
    <meta name="apple-mobile-web-app-title" content="Synth XR">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    
    <!-- Standard Favicons -->
    <link rel="icon" type="image/png" sizes="32x32" href="./icons/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="./icons/favicon-16x16.png">
    <meta name="theme-color" content="#6200ea">
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/tone/14.8.49/Tone.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/gsap.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <script src="js/enhanced-visualizers.js"></script>

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script type="module">
        import { builtInPresets } from './js/presets.js';
        window.builtInPresets = builtInPresets;
    </script>    
    <style>
        :root {
            /* Modern Color Scheme */
            --primary: #6200ea;
            --primary-light: #9d46ff;
            --primary-dark: #0a00b6;
            --secondary: #00e5ff;
            --secondary-light: #6effff;
            --secondary-dark: #00b2cc;
            --accent: #00b8d4;
            
            /* UI Colors */
            --background: #121212;
            --surface: #1e1e1e;
            --surface-light: #2a2a2a;
            --surface-dark: #181818;
            --panel: #252525;
            --text: #ffffff;
            --text-secondary: #b0b0b0;
            
            /* Functional Colors */
            --success: #00c853;
            --error: #ff1744;
            --warning: #ffab00;
            --info: #2196f3;
            
            /* Knob Colors */
            --knob-bg: #333333;
            --knob-indicator: var(--secondary);
            
            /* Animations */
            --transition-fast: 0.15s;
            --transition-normal: 0.3s;
            --transition-slow: 0.5s;
            
            /* Shadows */
            --shadow-small: 0 2px 5px rgba(0, 0, 0, 0.2);
            --shadow-normal: 0 4px 10px rgba(0, 0, 0, 0.3);
            --shadow-large: 0 8px 20px rgba(0, 0, 0, 0.4);
            
            /* Glows */
            --glow-primary: 0 0 10px rgba(157, 70, 255, 0.5);
            --glow-secondary: 0 0 10px rgba(0, 229, 255, 0.5);
        }
        
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }
        
        body {
            font-family: 'Inter', 'Roboto', 'Segoe UI', system-ui, -apple-system, sans-serif;
            background: var(--background);
            color: var(--text);
            line-height: 1.6;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            overflow-x: hidden;
            padding: 20px;
            user-select: none;
            -webkit-user-select: none;
            -moz-user-select: none;
        }
        
        #filterCutoffLow {
            display: block;
        }
        
        .advance-visualizer {
            grid-column: 1 / 13;
            margin-top: 20px;
        }

        .synth-container {
            width: 100%;
            max-width: 1400px;
            background: var(--surface);
            border-radius: 16px;
            box-shadow: var(--shadow-large), 
                        inset 0 1px 0 rgba(255, 255, 255, 0.1);
            display: grid;
            grid-template-columns: repeat(12, 1fr);
            grid-gap: 20px;
            padding: 25px;
            position: relative;
            overflow: hidden;
        }
        
        .synth-container::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 4px;
            background: linear-gradient(90deg, var(--primary), var(--secondary));
        }
        
        .brand {
            grid-column: 1 / 13;
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
        }
        
        .brand-name {
            font-size: 1.8rem;
            font-weight: 700;
            background: linear-gradient(90deg, var(--primary-light), var(--secondary));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            letter-spacing: -0.5px;
        }
        
        .version {
            color: var(--text-secondary);
            font-size: 0.8rem;
            opacity: 0.7;
        }
        
        .master-controls {
            grid-column: 1 / 13;
            display: flex;
            gap: 10px;
            margin-bottom: 10px;
        }
        
        .master-button {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            padding: 10px 15px;
            border-radius: 8px;
            background: var(--surface-light);
            border: none;
            color: var(--text);
            font-weight: 600;
            cursor: pointer;
            transition: all var(--transition-fast);
            box-shadow: var(--shadow-small);
        }
        
        .master-button:hover {
            background: var(--primary);
            color: white;
            box-shadow: var(--glow-primary);
            transform: translateY(-1px);
        }
        
        .master-button.playing {
            background: var(--primary);
            color: white;
            box-shadow: var(--glow-primary);
        }
        
        .master-button.success {
            background: var(--success);
        }
        
        .master-button i {
            font-size: 1rem;
        }
        
        .spacer {
            flex-grow: 1;
        }
        
        .module {
            background: var(--panel);
            border-radius: 12px;
            padding: 16px;
            box-shadow: var(--shadow-normal);
            display: flex;
            flex-direction: column;
            position: relative;
            overflow: scroll;
        }
        
        .module::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 3px;
            background: linear-gradient(90deg, var(--primary), var(--secondary-dark));
            opacity: 0.8;
        }
        
        .module-header {
            display: flex;
            align-items: center;
            margin-bottom: 16px;
            padding-bottom: 8px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .module-title {
            font-size: 1rem;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 1px;
            margin: 0;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .module-title i {
            color: var(--secondary);
            font-size: 0.9rem;
        }
              
        .oscillator-module { grid-column: 1 / 2; }
        .filter-module { grid-column: 2 / 3; }
        .effects-module { grid-column: 3 / 4; }
        
        .adsr-module {
            grid-column: 1 / 2;
        }
        
        .eq-module {
            grid-column: 2 / 3;
        }
        
        .drone-module {
            grid-column: 3 / 4;
        }
        
        .visualization {
            grid-column: 9 / 13;
            display: flex;
            flex-direction: column;
            gap: 20px;
        }

        .main-modules-1 {
            grid-column: 1 / 5;
            display: flex;
            flex-direction: column;
            gap: 20px;
        }

        .main-modules-2 {
            grid-column: 5 / 9;
            display: flex;
            flex-direction: column;
            gap: 20px;
        }
        
        .oscilloscope-module {
            flex: 1;
            min-height: 200px;
        }
                
        .sequencer-container {
            grid-column: 1 / 13;
        }
        
        .control-group {
            display: flex;
            flex-wrap: wrap;
            gap: 24px;
            margin-bottom: 14px;
        }
        
        .control-group:last-child {
            margin-bottom: 0;
        }
        
        /* New effect group styles */
        .effect-group {
            border: 1px dotted rgba(255, 255, 255, 0.3);
            border-radius: 8px;
            padding: 12px;
            margin-bottom: 14px;
        }
        
        .effect-group-label {
            font-size: 0.75rem;
            color: var(--text-secondary);
            text-transform: uppercase;
            letter-spacing: 0.5px;
            margin-bottom: 8px;
            display: flex;
            align-items: center;
            gap: 5px;
        }
        
        .effect-group-label i {
            color: var(--secondary);
            font-size: 0.8rem;
        }
        
        .knob-container {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 8px;
            position: relative;
            flex: 1;
            min-width: 80px;
        }
        
        .knob-label {
            font-size: 0.75rem;
            color: var(--text-secondary);
            text-align: center;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }
        
        .knob {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            background: var(--knob-bg);
            position: relative;
            cursor: pointer;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.3),
                        inset 0 2px 3px rgba(0, 0, 0, 0.5);
            display: flex;
            align-items: center;
            justify-content: center;
            overflow: hidden;
        }
        
        .knob-inner {
            width: 72%;
            height: 72%;
            border-radius: 50%;
            background: linear-gradient(135deg, #444, #222);
            box-shadow: inset 0 1px 3px rgba(0, 0, 0, 0.3);
        }
        
        .knob::before {
            content: '';
            position: absolute;
            width: 4px;
            height: 20px;
            background: var(--knob-indicator);
            top: 5px;
            left: 50%;
            transform: translateX(-50%);
            border-radius: 2px;
            box-shadow: 0 0 5px var(--knob-indicator);
        }
        
        .knob::after {
            content: '';
            position: absolute;
            width: 10px;
            height: 10px;
            border-radius: 50%;
            background: var(--knob-indicator);
            top: 10px;
            left: 50%;
            transform: translateX(-50%);
            box-shadow: 0 0 5px var(--knob-indicator);
            opacity: 0.8;
        }
        
        .knob-value {
            margin-top: 4px;
            font-family: 'Roboto Mono', monospace;
            font-size: 0.8rem;
            color: var(--secondary);
            text-shadow: 0 0 5px rgba(0, 229, 255, 0.3);
        }
        
        .select-container {
            display: flex;
            flex-direction: column;
            gap: 8px;
            flex: 1;
        }
        
        .select-label {
            font-size: 0.75rem;
            color: var(--text-secondary);
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }
        
        select {
            background: var(--surface-dark);
            color: var(--text);
            border: 1px solid rgba(255, 255, 255, 0.1);
            padding: 8px 12px;
            border-radius: 6px;
            font-size: 0.9rem;
            cursor: pointer;
            transition: all var(--transition-fast);
            appearance: none;
            background-image: url("data:image/svg+xml;charset=UTF-8,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='white' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3e%3cpolyline points='6 9 12 15 18 9'%3e%3c/polyline%3e%3c/svg%3e");
            background-repeat: no-repeat;
            background-position: right 12px center;
            background-size: 16px;
            padding-right: 36px;
        }
        
        select:hover, select:focus {
            border-color: var(--primary);
            box-shadow: var(--glow-primary);
            outline: none;
        }
        
        /* Toggle switch styling */
        .toggle-container {
            display: flex;
            flex-direction: column;
            gap: 8px;
            align-items: center;
        }
        
        .toggle-label {
            font-size: 0.75rem;
            color: var(--text-secondary);
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }
        
        .toggle-switch {
            position: relative;
            display: inline-block;
            width: 50px;
            height: 24px;
        }
        
        .toggle-switch input {
            opacity: 0;
            width: 0;
            height: 0;
        }
        
        .toggle-slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: var(--surface-dark);
            transition: .4s;
            border-radius: 24px;
        }
        
        .toggle-slider:before {
            position: absolute;
            content: "";
            height: 16px;
            width: 16px;
            left: 4px;
            bottom: 4px;
            background-color: var(--text);
            transition: .4s;
            border-radius: 50%;
        }
        
        input:checked + .toggle-slider {
            background-color: var(--primary);
        }
        
        input:checked + .toggle-slider:before {
            transform: translateX(26px);
        }
        
        .toggle-state {
            font-size: 0.7rem;
            color: var(--text-secondary);
            margin-top: 4px;
        }
        
        .oscilloscope {
            width: 100%;
            height: 100%;
            position: relative;
            overflow: hidden;
            border-radius: 6px;
            background: var(--background);
            box-shadow: inset 0 0 10px rgba(0, 0, 0, 0.5);
        }
        
        .oscilloscope-grid {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-image: 
                linear-gradient(rgba(255, 255, 255, 0.05) 1px, transparent 1px),
                linear-gradient(90deg, rgba(255, 255, 255, 0.05) 1px, transparent 1px);
            background-size: 20px 20px;
            background-position: center center;
            z-index: 1;
        }
        
        .oscilloscope canvas {
            width: 100%;
            height: 100%;
            position: absolute;
            top: 0;
            left: 0;
            z-index: 2;
        }
        
        .vu-meter {
            height: 24px;
            background: var(--background);
            border-radius: 12px;
            margin-top: 16px;
            overflow: hidden;
            box-shadow: inset 0 0 5px rgba(0, 0, 0, 0.5);
            position: relative;
        }
        
        .vu-meter-fill {
            height: 100%;
            width: 0%;
            background: linear-gradient(90deg, var(--primary), var(--secondary), var(--error));
            transition: width 0.05s;
            border-radius: 12px;
        }
        
        .vu-meter::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-image: 
                linear-gradient(90deg, transparent 9%, rgba(255, 255, 255, 0.1) 10%, transparent 11%),
                linear-gradient(90deg, transparent 24%, rgba(255, 255, 255, 0.1) 25%, transparent 26%),
                linear-gradient(90deg, transparent 49%, rgba(255, 255, 255, 0.1) 50%, transparent 51%),
                linear-gradient(90deg, transparent 74%, rgba(255, 255, 255, 0.1) 75%, transparent 76%),
                linear-gradient(90deg, transparent 89%, rgba(255, 255, 255, 0.1) 90%, transparent 91%);
            pointer-events: none;
        }
        
        .sequencer {
            display: grid;
            grid-template-columns: repeat(16, 1fr);
            gap: 6px;
            position: relative;
        }
        
        .step {
            background: var(--surface-dark);
            border-radius: 6px;
            display: flex;
            flex-direction: column;
            gap: 6px;
            padding: 10px;
            transition: all var(--transition-fast);
            position: relative;
            overflow: hidden;
            box-shadow: var(--shadow-small);
        }
        
        .step-led {
            width: 14px;
            height: 14px;
            border-radius: 50%;
            background: var(--knob-bg);
            align-self: center;
            transition: all var(--transition-fast);
            box-shadow: inset 0 0 3px rgba(0, 0, 0, 0.5);
        }
        
        .step select {
            padding: 6px;
            font-size: 0.8rem;
        }
        
        .step-toggle {
            background: var(--surface-light);
            color: var(--text-secondary);
            border: none;
            border-radius: 4px;
            padding: 4px 6px;
            font-size: 0.7rem;
            cursor: pointer;
            transition: all var(--transition-fast);
        }
        
        .step-toggle.active {
            background: var(--primary);
            color: white;
        }
        
        .step.active {
            background: var(--surface-light);
            box-shadow: 0 0 10px rgba(157, 70, 255, 0.3);
        }
        
        .step.active .step-led {
            background: var(--primary);
            box-shadow: 0 0 10px var(--primary-light);
        }
        
        .step::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 2px;
            background: var(--primary-light);
            transform: scaleX(0);
            transition: transform var(--transition-fast);
            transform-origin: left;
        }
        
        .step.active::before {
            transform: scaleX(1);
        }
        
        .keyboard {
            display: flex;
            /* justify-content: center; */
            margin-top: 20px;
            height: 80px;
            position: relative;
            transform-style: preserve-3d;
            perspective: 500px;
        }
        
        .key {
            flex: 1;
            max-width: 40px;
            height: 100%;
            background: var(--surface-light);
            border: 1px solid var(--surface-dark);
            border-radius: 0 0 5px 5px;
            display: flex;
            align-items: flex-end;
            justify-content: center;
            padding-bottom: 8px;
            font-size: 0.8rem;
            color: var(--text-secondary);
            cursor: pointer;
            transform-origin: top;
            transition: transform 0.1s, background 0.1s;
            position: relative;
            z-index: 1;
            box-shadow: 0 5px 10px rgba(0, 0, 0, 0.2);
        }
        
        .key:hover {
            background: var(--surface);
        }
        
        .key.active {
            background: var(--primary-light);
            color: white;
        }
        
        .black-key {
            position: absolute;
            width: 24px;
            height: 60%;
            background: var(--background);
            border-radius: 0 0 3px 3px;
            z-index: 2;
            cursor: pointer;
            transition: transform 0.1s, background 0.1s;
            box-shadow: 0 5px 10px rgba(0, 0, 0, 0.4);
        }
        
        .black-key:hover {
            background: #000;
        }
        
        .black-key.active {
            background: var(--primary-light);
        }

        .preset-module {
            flex: 2;
            max-height: 600px;
        }

        .preset-list {
            display: flex;
            flex-direction: column;
            gap: 8px;
            overflow-y: auto;
            padding-right: 8px;
        }
        
        .preset-item {
            background: var(--surface-dark);
            padding: 10px;
            border-radius: 6px;
            cursor: pointer;
            transition: all var(--transition-fast);
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .preset-item:hover {
            background: var(--surface-light);
        }
        
        .preset-item.active {
            background: var(--primary-dark);
        }
        
        .preset-item i {
            color: var(--primary-light);
        }
        
        .preset-name {
            flex-grow: 1;
        }
        
        .preset-actions {
            display: flex;
            gap: 8px;
            margin-top: 12px;
        }
        
        .preset-actions button {
            flex: 1;
            padding: 8px;
            border: none;
            border-radius: 6px;
            background: var(--surface-light);
            color: var(--text);
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 6px;
            transition: all var(--transition-fast);
        }
        
        .preset-actions button:hover {
            background: var(--primary);
            color: white;
        }
        
        .tooltip {
            position: absolute;
            bottom: 100%;
            left: 50%;
            transform: translateX(-50%);
            padding: 4px 8px;
            background: var(--surface-dark);
            color: var(--text);
            font-size: 0.7rem;
            border-radius: 4px;
            white-space: nowrap;
            opacity: 0;
            pointer-events: none;
            transition: opacity var(--transition-fast);
            box-shadow: var(--shadow-small);
        }
        
        *:hover > .tooltip {
            opacity: 1;
        }
        
        /* Preset tag styles */
        .preset-tag {
            font-size: 0.6rem;
            padding: 2px 6px;
            border-radius: 4px;
            margin-left: 5px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }
        
        .preset-tag.bass {
            background-color: #00796B;
            color: white;
        }
        
        .preset-tag.lead {
            background-color: #C2185B;
            color: white;
        }
        
        .preset-tag.pad {
            background-color: #303F9F;
            color: white;
        }
        
        .preset-tag.fx {
            background-color: #7B1FA2;
            color: white;
        }
        
        .preset-tag.pluck {
            background-color: #0288D1;
            color: white;
        }
        
        .preset-tag.keys {
            background-color: #689F38;
            color: white;
        }
        
        .preset-tag.custom {
            background-color: #FFA000;
            color: white;
        }

        /* Modal styles for preset naming */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.7);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 1000;
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.3s, visibility 0.3s;
        }
        
        .modal-overlay.active {
            opacity: 1;
            visibility: visible;
        }
        
        .modal {
            background: var(--surface);
            border-radius: 12px;
            padding: 20px;
            width: 90%;
            max-width: 400px;
            box-shadow: var(--shadow-large);
            transform: translateY(20px);
            transition: transform 0.3s;
        }
        
        .modal-overlay.active .modal {
            transform: translateY(0);
        }
        
        .modal-header {
            margin-bottom: 16px;
            padding-bottom: 10px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .modal-title {
            font-size: 1.2rem;
            font-weight: 600;
            margin: 0;
            color: var(--text);
        }
        
        .modal-body {
            margin-bottom: 20px;
        }
        
        .modal-input {
            width: 100%;
            background: var(--surface-dark);
            border: 1px solid rgba(255, 255, 255, 0.1);
            color: var(--text);
            padding: 10px 12px;
            border-radius: 6px;
            font-size: 1rem;
            margin-top: 10px;
        }
        
        .modal-input:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: var(--glow-primary);
        }

        .modal-select {
            width: 100%;
            background: var(--surface-dark);
            border: 1px solid rgba(255, 255, 255, 0.1);
            color: var(--text);
            padding: 10px 12px;
            border-radius: 6px;
            font-size: 1rem;
            margin-top: 10px;
            appearance: none;
            background-image: url("data:image/svg+xml;charset=UTF-8,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='white' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3e%3cpolyline points='6 9 12 15 18 9'%3e%3c/polyline%3e%3c/svg%3e");
            background-repeat: no-repeat;
            background-position: right 12px center;
            background-size: 16px;
        }
        
        .modal-select:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: var(--glow-primary);
        }
        
        .modal-actions {
            display: flex;
            justify-content: flex-end;
            gap: 10px;
        }
        
        .modal-button {
            padding: 8px 16px;
            border: none;
            border-radius: 6px;
            font-weight: 600;
            cursor: pointer;
            transition: all var(--transition-fast);
        }
        
        .modal-button.cancel {
            background: var(--surface-light);
            color: var(--text);
        }
        
        .modal-button.confirm {
            background: var(--primary);
            color: white;
        }
        
        .modal-button:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-small);
        }
        
        .modal-button.cancel:hover {
            background: var(--surface);
        }
        
        .modal-button.confirm:hover {
            background: var(--primary-light);
            box-shadow: var(--glow-primary);
        }

        /* New visualizations */
        .adsr-visualizer {
            height: 70px;
            background: var(--background);
            border-radius: 6px;
            margin-top: 10px;
            position: relative;
            box-shadow: inset 0 0 5px rgba(0, 0, 0, 0.5);
            overflow: hidden;
        }

        .adsr-graph {
            height: 100%;
            width: 100%;
            position: relative;
        }

        .adsr-path {
            stroke: var(--secondary);
            stroke-width: 2;
            fill: none;
            filter: drop-shadow(0 0 2px var(--secondary));
        }

        .adsr-marker {
            position: absolute;
            width: 8px;
            height: 8px;
            background: var(--secondary);
            border-radius: 50%;
            transform: translate(-50%, -50%);
            box-shadow: 0 0 5px var(--secondary);
        }

        .filter-response {
            height: 70px;
            background: var(--background);
            border-radius: 6px;
            margin-top: 10px;
            position: relative;
            box-shadow: inset 0 0 5px rgba(0, 0, 0, 0.5);
            overflow: hidden;
        }

        .filter-curve {
            stroke: var(--secondary);
            stroke-width: 2;
            fill: none;
            filter: drop-shadow(0 0 2px var(--secondary));
        }

        .filter-area {
            fill: rgba(0, 229, 255, 0.1);
        }

        .advanced-visualizers {
            display: flex;
            gap: 15px;
            margin-top: 20px;
            overflow: hidden;
            transition: max-height 0.3s;
        }
        
        .visualizer-toggle {
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 8px;
            background: var(--surface-dark);
            border-radius: 6px;
            margin-top: 10px;
            cursor: pointer;
            transition: all var(--transition-fast);
        }
        
        .visualizer-toggle:hover {
            background: var(--surface-light);
        }
        
        .visualizer-toggle i {
            margin-right: 8px;
            color: var(--secondary);
            transition: transform 0.3s;
        }
        
        .visualizer-toggle.active i {
            transform: rotate(180deg);
        }

        .spectrum-analyzer, 
        .waveform-3d, 
        .particle-system {
            height: 150px;
            background: var(--background);
            border-radius: 6px;
            position: relative;
            box-shadow: inset 0 0 5px rgba(0, 0, 0, 0.5);
            overflow: hidden;
            margin: auto;
        }

        .visualizer-title {
            position: absolute;
            top: 10px;
            left: 10px;
            font-size: 0.75rem;
            color: var(--text-secondary);
            z-index: 5;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            pointer-events: none;
        }

        /* Custom scrollbar */
        ::-webkit-scrollbar {
            width: 6px;
            height: 6px;
        }
        
        ::-webkit-scrollbar-track {
            background: var(--surface-dark);
            border-radius: 3px;
        }
        
        ::-webkit-scrollbar-thumb {
            background: var(--primary-dark);
            border-radius: 3px;
        }
        
        ::-webkit-scrollbar-thumb:hover {
            background: var(--primary);
        }

        /* Sequencer key highlight animation */
        @keyframes keyHighlight {
            0% { background: var(--surface-light); }
            50% { background: var(--primary-light); }
            100% { background: var(--surface-light); }
        }

        input[type="range"] {
            display: none;
        }
        
        /* Responsive design */
        @media (max-width: 1200px) {
            .synth-container {
                grid-template-columns: repeat(6, 1fr);
            }
            
            .brand {
                grid-column: 1 / 7;
            }
            
 
            .oscillator-module { grid-column: 1 / 2; }
            .filter-module { grid-column: 2 / 3; }
            .effects-module { grid-column: 1 / 3; }
            .adsr-module { grid-column: 1 / 3; }
            .drone-module { grid-column: 1 / 3; }
            
            .visualization {
                grid-column: 1 / 13;
                display: grid;
                grid-template-columns: 2fr 1fr;
                gap: 20px;
            }
            
            .main-modules-1 {
                grid-column: 1 / 13;
            }
            
            .main-modules-2 {
                grid-column: 1 / 13;
            }            
            .oscilloscope {
                height: 120px;
            }
            
            .oscilloscope-module {
                grid-column: 1 / 2;
            }
            
            .preset-module {
                grid-column: 2 / 3;
            }
            
            .sequencer-container {
                grid-column: 1 / 7;
            }
        }
        
        @media (max-width: 768px) {
            .brand {
                margin-bottom: 15px;
            }
            
            .main-modules {
                grid-template-columns: 1fr;
            }
            
            .oscillator-module,
            .filter-module,
            .effects-module,
            .adsr-module,
            .drone-module {
                grid-column: 1 / 7;
            }
            
            .visualization {
                grid-template-columns: 1fr;
            }
            
            .oscilloscope-module,
            .preset-module,
            .lfo-module {
                grid-column: 1 / 7;
            }
            
            .lfo-module .control-group {
                flex-wrap: wrap;
                justify-content: center;
            }
            
            .control-group {
                gap: 15px;
            }
            
            .knob {
                width: 50px;
                height: 50px;
            }
            
            .sequencer {
                grid-template-columns: repeat(8, 1fr);
                grid-template-rows: repeat(2, auto);
            }
            
            .keyboard {
                height: 60px;
                overflow-x: auto;
                padding-bottom: 10px;
            }
            
            .key {
                min-width: 30px;
            }
        }
        
        @media (max-width: 480px) {
            .brand-name {
                font-size: 1.5rem;
            }
            
            .master-controls {
                flex-wrap: wrap;
            }
            
            .module {
                grid-column: 1 / 13;
                padding: 12px;
                max-height: 100vh;
            }
            
            .module-title {
                font-size: 0.9rem;
            }
            
            .lfo-module .control-group {
                gap: 10px;
            }
            
            .lfo-module .select-container {
                min-width: 100%;
                margin-bottom: 8px;
            }
            
            .sequencer {
                grid-template-columns: repeat(4, 1fr);
                grid-template-rows: repeat(4, auto);
            }
            
            .knob-container {
                min-width: 60px;
            }
            
            .knob {
                width: 40px;
                height: 40px;
            }
        }

        .lfo-scope {
            height: 80px;
            margin-top: 10px;
            background: var(--background);
            border-radius: 6px;
            position: relative;
            box-shadow: inset 0 0 5px rgba(0, 0, 0, 0.5);
            overflow: hidden;
        }
        
        #lfoScope {
            width: 100%;
            height: 100%;
            display: block;
        }
        
        /* Drone module styles */
        .drone-button {
            padding: 10px 20px;
            font-size: 1rem;
            background: var(--surface-light);
            color: var(--text);
            border: none;
            border-radius: 8px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            transition: all var(--transition-normal);
            box-shadow: var(--shadow-small);
            margin: auto;
        }
        
        .drone-button:hover {
            background: var(--primary);
            box-shadow: var(--glow-primary);
            transform: translateY(-2px);
        }
        
        .drone-button.active {
            background: var(--primary);
            box-shadow: var(--glow-primary);
        }
        
        .drone-visualizer {
            height: 120px;
            margin-top: 16px;
            background: var(--background);
            border-radius: 6px;
            position: relative;
            box-shadow: inset 0 0 5px rgba(0, 0, 0, 0.5);
            overflow: hidden;
        }
        
        .drone-wave {
            position: absolute;
            bottom: 0;
            left: 0;
            width: 100%;
            height: 100%;
            display: flex;
            align-items: center;
            justify-content: center;
            overflow: hidden;
        }
        
        .drone-wave span {
            position: absolute;
            width: 100%;
            height: 3px;
            background: var(--secondary);
            box-shadow: 0 0 10px var(--secondary);
            border-radius: 100%;
        }
        
        .drone-wave.active span {
            animation: drone-wave 2s linear infinite;
        }
        
        @keyframes drone-wave {
            0% {
                transform: scale(0);
                opacity: 1;
            }
            100% {
                transform: scale(3);
                opacity: 0;
            }
        }
        
        .drone-wave.active span:nth-child(2) {
            animation-delay: 0.3s;
        }
        
        .drone-wave.active span:nth-child(3) {
            animation-delay: 0.6s;
        }
        
        .drone-wave.active span:nth-child(4) {
            animation-delay: 0.9s;
        }
        
        .drone-wave.active span:nth-child(5) {
            animation-delay: 1.2s;
        }
        
        /* Panic button style */
        .panic-button {
            background-color: var(--error);
            color: white;
        }
        
        .panic-button:hover {
            background-color: #d50000;
        }

        /* EQ Response visualization improvements */
        .eq-response {
            width: 100%;
            height: 120px;  /* Increased height for better visibility */
            background: var(--background);
            border-radius: 6px;
            overflow: hidden;
            box-shadow: inset 0 0 10px rgba(0, 0, 0, 0.5);
            margin-top: 14px;
            position: relative;
        }
        
        .eq-response svg {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
        }
        
        .eq-curve {
            fill: none;
            stroke: var(--secondary);
            stroke-width: 2.5px;
            stroke-linecap: round;
            filter: drop-shadow(0 0 4px var(--secondary));
        }
        
        .eq-area {
            opacity: 0.3;
        }
        
        .eq-grid {
            stroke: rgba(255, 255, 255, 0.08);
            stroke-width: 1px;
        }
        
        .eq-zero-line {
            stroke: rgba(255, 255, 255, 0.3);
            stroke-width: 1px;
            stroke-dasharray: 4 2;
        }
        
        .eq-label {
            fill: var(--text-secondary);
            font-size: 8px;
            font-family: 'Roboto Mono', monospace;
            text-anchor: middle;
        }
        
        .eq-gain-label {
            fill: var(--text-secondary);
            font-size: 8px;
            font-family: 'Roboto Mono', monospace;
            text-anchor: end;
        }
        
        .eq-frequency-marker {
            fill: rgba(255, 255, 255, 0.2);
            stroke: none;
        }
        
        .eq-mid-marker {
            stroke: var(--primary-light);
            stroke-width: 1px;
            stroke-dasharray: 2 2;
            opacity: 0.7;
        }

        /* Fine control slider styling */
        .fine-control-container {
            width: 100%;
            margin-top: 8px;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 4px;
        }
        
        .fine-control-slider {
            width: 100%;
            height: 4px;
            -webkit-appearance: none;
            appearance: none;
            background: linear-gradient(90deg, var(--primary-dark), var(--primary-light));
            border-radius: 4px;
            outline: none;
            opacity: 0.7;
            transition: opacity 0.2s;
        }
        
        .fine-control-slider:hover {
            opacity: 1;
        }
        
        .fine-control-slider::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 12px;
            height: 12px;
            border-radius: 50%;
            background: var(--secondary);
            cursor: pointer;
            box-shadow: 0 0 4px var(--secondary);
        }
        
        .fine-control-slider::-moz-range-thumb {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            background: var(--secondary);
            cursor: pointer;
            box-shadow: 0 0 4px var(--secondary);
        }
        
        .fine-control-label {
            font-size: 0.6rem;
            color: var(--text-secondary);
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }
        
        .compact-controls {
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
            justify-content: space-between;
        }
        
        .small-knob-container {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 5px;
            position: relative;
            flex: 1;
            min-width: 60px;
        }
        
        .small-knob {
            width: 45px;
            height: 45px;
            border-radius: 50%;
            background: var(--knob-bg);
            position: relative;
            cursor: pointer;
            box-shadow: 0 3px 6px rgba(0, 0, 0, 0.3),
                        inset 0 2px 3px rgba(0, 0, 0, 0.5);
            display: flex;
            align-items: center;
            justify-content: center;
            overflow: hidden;
        }
        
        .small-knob-inner {
            width: 72%;
            height: 72%;
            border-radius: 50%;
            background: linear-gradient(135deg, #444, #222);
            box-shadow: inset 0 1px 3px rgba(0, 0, 0, 0.3);
        }
        
        .small-knob::before {
            content: '';
            position: absolute;
            width: 3px;
            height: 15px;
            background: var(--knob-indicator);
            top: 5px;
            left: 50%;
            transform: translateX(-50%);
            border-radius: 2px;
            box-shadow: 0 0 5px var(--knob-indicator);
        }
        
        .small-knob::after {
            content: '';
            position: absolute;
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background: var(--knob-indicator);
            top: 8px;
            left: 50%;
            transform: translateX(-50%);
            box-shadow: 0 0 5px var(--knob-indicator);
            opacity: 0.8;
        }
        
        .mastering-module .knob-label {
            font-size: 0.7rem;
        }
        
        .mastering-module .knob-value {
            font-size: 0.7rem;
        }
        
        .button-group-label {
            font-size: 0.75rem;
            color: var(--text-secondary);
            text-transform: uppercase;
            letter-spacing: 0.5px;
            margin-bottom: 8px;
        }
        
        .chord-buttons, .note-buttons {
            display: flex;
            flex-wrap: wrap;
            gap: 6px;
            margin-bottom: 12px;
        }
        
        .chord-button, .note-button {
            background: var(--surface-dark);
            color: var(--text);
            border: none;
            border-radius: 4px;
            padding: 6px 10px;
            font-size: 0.8rem;
            cursor: pointer;
            transition: all var(--transition-fast);
            flex-grow: 1;
            text-align: center;
            min-width: calc(25% - 6px);
        }
        
        .chord-button:hover, .note-button:hover {
            background: var(--surface-light);
            transform: translateY(-2px);
            box-shadow: var(--shadow-small);
        }
        
        .chord-button.active, .note-button.active {
            background: var(--primary);
            color: white;
            box-shadow: var(--glow-primary);
        }
        
        /* For smaller screens, make buttons wrap better */
        @media (max-width: 768px) {
            .chord-button, .note-button {
                min-width: calc(33.33% - 6px);
            }
        }
        
        @media (max-width: 480px) {
            .chord-button, .note-button {
                min-width: calc(50% - 6px);
            }
        }
        
        /* Quick Chord module with pagination octave control */
        .module-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }
        
        .octave-pagination {
            display: flex;
            align-items: center;
            background: var(--surface-dark);
            border-radius: 4px;
            padding: 2px;
            box-shadow: inset 0 1px 3px rgba(0, 0, 0, 0.3);
        }
        
        .octave-page-btn {
            display: flex;
            align-items: center;
            justify-content: center;
            width: 24px;
            height: 24px;
            border: none;
            background: var(--surface);
            color: var(--text-secondary);
            border-radius: 3px;
            cursor: pointer;
            transition: all var(--transition-fast);
        }
        
        .octave-page-btn:hover {
            background: var(--surface-light);
            color: var(--text);
            box-shadow: var(--shadow-small);
        }
        
        .octave-page-display {
            padding: 0 10px;
            font-size: 0.9rem;
            font-weight: 600;
            color: var(--primary-light);
            user-select: none;
        }
        
        /* Rest of the Quick Chord module styles */
        .chord-controls-container {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }
        
        .chord-controls {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }
        
        .button-group-label {
            font-size: 0.75rem;
            color: var(--text-secondary);
            text-transform: uppercase;
            letter-spacing: 0.5px;
            margin-bottom: 4px;
        }
        
        .chord-buttons, .note-buttons {
            display: flex;
            flex-wrap: wrap;
            gap: 6px;
            margin-bottom: 6px;
        }
        
        .chord-button, .note-button {
            background: var(--surface-dark);
            color: var(--text);
            border: none;
            border-radius: 4px;
            padding: 6px 10px;
            font-size: 0.8rem;
            cursor: pointer;
            transition: all var(--transition-fast);
            flex-grow: 1;
            text-align: center;
            min-width: calc(25% - 6px);
        }
        
        .chord-button:hover, .note-button:hover {
            background: var(--surface-light);
            transform: translateY(-2px);
            box-shadow: var(--shadow-small);
        }
        
        .chord-button.active, .note-button.active {
            background: var(--primary);
            color: white;
            box-shadow: var(--glow-primary);
        }
        
        /* For smaller screens, make buttons wrap better */
        @media (max-width: 768px) {
            .chord-button, .note-button {
                min-width: calc(33.33% - 6px);
            }
        }
        
        @media (max-width: 480px) {
            .chord-button, .note-button {
                min-width: calc(50% - 6px);
            }
        }

        /* Drum Loop Module Styles */
        .drum-loop-module {
            grid-column: 1 / 13;
            margin-top: 20px;
        }

        .drum-grid {
            display: flex;
            flex-direction: column;
            gap: 12px;
            margin-top: 15px;
        }

        .drum-row {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .drum-label {
            width: 80px;
            font-size: 0.9rem;
            font-weight: 600;
            color: var(--text);
            text-align: right;
        }

        .drum-volume-control {
            display: flex;
            flex-direction: column;
            align-items: center;
            width: 60px;
            margin-right: 10px;
        }

        .drum-steps {
            display: grid;
            grid-template-columns: repeat(16, 1fr);
            gap: 5px;
            flex-grow: 1;
        }

        .drum-step {
            background: var(--surface-dark);
            border-radius: 4px;
            height: 35px;
            cursor: pointer;
            transition: all var(--transition-fast);
            box-shadow: var(--shadow-small);
            position: relative;
        }

        .drum-step:hover {
            background: var(--surface-light);
            transform: translateY(-2px);
        }

        .drum-step.active {
            background: var(--primary);
            box-shadow: 0 0 10px var(--primary-light);
        }

        .drum-step.playing {
            background: var(--secondary);
            box-shadow: 0 0 15px var(--secondary);
            transform: scale(1.05);
        }

        /* Beat markers for better visual rhythm */
        .drum-step:nth-child(4n+1) {
            border-left: 2px solid rgba(255, 255, 255, 0.2);
        }

        /* Kick specific styling */
        .drum-row[data-drum="kick"] .drum-step.active {
            background: var(--primary);
        }

        /* Snare specific styling */
        .drum-row[data-drum="snare"] .drum-step.active {
            background: tomato;
        }

        /* Hihat specific styling */
        .drum-row[data-drum="hihat"] .drum-step.active {
            background: var(--warning);
        }

        /* Clap specific styling */
        .drum-row[data-drum="clap"] .drum-step.active {
            background: var(--success);
        }

        /* Drum volume knob */
        .drum-volume-knob {
            width: 36px;
            height: 36px;
            border-radius: 50%;
            background: var(--knob-bg);
            position: relative;
            cursor: pointer;
            box-shadow: 0 3px 5px rgba(0, 0, 0, 0.3),
                        inset 0 2px 3px rgba(0, 0, 0, 0.5);
            display: flex;
            align-items: center;
            justify-content: center;
            overflow: hidden;
        }

        .drum-volume-knob-inner {
            width: 72%;
            height: 72%;
            border-radius: 50%;
            background: linear-gradient(135deg, #444, #222);
            box-shadow: inset 0 1px 3px rgba(0, 0, 0, 0.3);
        }

        .drum-volume-knob::before {
            content: '';
            position: absolute;
            width: 3px;
            height: 12px;
            background: var(--knob-indicator);
            top: 5px;
            left: 50%;
            transform: translateX(-50%);
            border-radius: 2px;
            box-shadow: 0 0 5px var(--knob-indicator);
        }

        .drum-volume-value {
            margin-top: 4px;
            font-family: 'Roboto Mono', monospace;
            font-size: 0.7rem;
            color: var(--secondary);
            text-shadow: 0 0 5px rgba(0, 229, 255, 0.3);
        }

        /* Responsive adjustments for drum module */
        @media (max-width: 992px) {
            .drum-steps {
                gap: 3px;
            }
        }

        @media (max-width: 768px) {
            .drum-row {
                flex-direction: column;
                align-items: flex-start;
                gap: 8px;
                margin-bottom: 15px;
            }
            
            .drum-label-container {
                display: flex;
                width: 100%;
                align-items: center;
                justify-content: space-between;
                margin-bottom: 5px;
            }
            
            .drum-label {
                width: auto;
                text-align: left;
                margin-right: 10px;
            }
            
            .drum-volume-control {
                width: auto;
                flex-direction: row;
                align-items: center;
                gap: 10px;
                margin-bottom: 0;
            }
            
            .drum-steps {
                width: 100%;
            }
            
            .drum-step {
                height: 30px;
            }
        }

        @media (max-width: 480px) {
            .drum-steps {
                grid-template-columns: repeat(8, 1fr);
                grid-template-rows: repeat(2, 1fr);
                gap: 3px;
            }
            
            .drum-step {
                height: 25px;
            }
        }

        /* Add responsive styling for master controls */
        @media (max-width: 768px) {
            /* Change display order using CSS Grid */
            .synth-container {
                display: grid;
                grid-template-rows: auto auto 1fr auto;
            }
            
            .brand {
                grid-row: 1;
            }
            
            /* Move master controls to the bottom */
            .master-controls {
                grid-row: 7; /* Place at the end */
                margin-top: 20px;
                margin-bottom: 0;
                padding-top: 15px;
                border-top: 1px solid rgba(255, 255, 255, 0.1);
                position: sticky;
                bottom: 0;
                background: var(--surface);
                z-index: 10;

            }
            
            /* For even smaller screens, make buttons stack vertically if needed */
            @media (max-width: 480px) {
                .master-controls {
                    flex-wrap: wrap;
                    justify-content: center;
                    border: none;
                }

                .spacer {
                    display: none;
                }
            }
        }
    </style>
</head>
<body>
    <div class="synth-container">
        <div class="brand">
            <div class="brand-name">Synth XR</div>
            <div class="version">v5.0</div>
        </div>
        
        <div class="master-controls">
            <button class="master-button" id="nudgeButton">
                <i class="fas fa-random"></i>
                <span>Nudge</span>
            </button>
            <button class="master-button" id="chaosButton">
                <i class="fas fa-bolt"></i>
                <span>Chaos</span>
            </button>
            
            <div class="spacer"></div>
            
            <button class="master-button" id="initPatchButton">
                <i class="fas fa-undo"></i>
                <span>Init Patch</span>
            </button>
        </div>
        
        <div class="main-modules-1">
            <div class="module oscillator-module">
                <div class="module-header">
                    <h3 class="module-title">
                        <i class="fas fa-wave-square"></i>
                        Oscillator
                    </h3>
                </div>
                <div class="control-group">
                    <div class="select-container">
                        <label class="select-label">Waveform</label>
                        <select id="waveform">
                            <option value="sine">Sine</option>
                            <option value="square">Square</option>
                            <option value="sawtooth">Sawtooth</option>
                            <option value="triangle">Triangle</option>
                            <option value="pulse">Pulse</option>
                            <option value="fmsine">FM Sine</option>
                            <option value="amsine">AM Sine</option>
                            <option value="fatsawtooth">Fat Saw</option>
                            <option value="fatsquare" selected>Fat Square</option>
                        </select>
                    </div>
                </div>
                <div class="control-group">
                    <div class="knob-container">
                        <label class="knob-label">Tempo</label>
                        <div class="knob" id="tempoKnob">
                            <div class="knob-inner"></div>
                            <div class="tooltip">Adjust tempo</div>
                        </div>
                        <input type="range" id="tempo" min="60" max="200" value="120">
                        <span class="knob-value" id="tempoValue">120 BPM</span>
                    </div>
                </div>
                <!-- New control group for octave, semi, and level knobs -->
                <div class="control-group">
                    <div class="knob-container">
                        <label class="knob-label">Octave</label>
                        <div class="knob" id="oscillatorOctaveKnob">
                            <div class="knob-inner"></div>
                            <div class="tooltip">Adjust octave</div>
                        </div>
                        <input type="range" id="oscillatorOctave" min="-2" max="2" step="1" value="0">
                        <span class="knob-value" id="oscillatorOctaveValue">0</span>
                    </div>
                    <div class="knob-container">
                        <label class="knob-label">Semi</label>
                        <div class="knob" id="oscillatorSemiKnob">
                            <div class="knob-inner"></div>
                            <div class="tooltip">Adjust detune in semitones</div>
                        </div>
                        <input type="range" id="oscillatorSemi" min="-12" max="12" step="1" value="0">
                        <span class="knob-value" id="oscillatorSemiValue">0</span>
                    </div>
                    <div class="knob-container">
                        <label class="knob-label">Level</label>
                        <div class="knob" id="oscillatorLevelKnob">
                            <div class="knob-inner"></div>
                            <div class="tooltip">Adjust oscillator volume</div>
                        </div>
                        <input type="range" id="oscillatorLevel" min="0" max="1" step="0.01" value="0.8">
                        <span class="knob-value" id="oscillatorLevelValue">0.80</span>
                    </div>
                </div>
                <div class="control-group">
                    <div class="knob-container">
                        <label class="knob-label">Detune</label>
                        <div class="knob" id="detuneKnob">
                            <div class="knob-inner"></div>
                            <div class="tooltip">Adjust oscillator detune</div>
                        </div>
                        <input type="range" id="detune" min="-100" max="100" step="1" value="0">
                        <span class="knob-value" id="detuneValue">0 ¢</span>
                    </div>
                    <div class="knob-container">
                        <label class="knob-label">Voices</label>
                        <div class="knob" id="voicesKnob">
                            <div class="knob-inner"></div>
                            <div class="tooltip">Adjust number of voices</div>
                        </div>
                        <input type="range" id="voices" min="1" max="8" step="1" value="8">
                        <span class="knob-value" id="voicesValue">8</span>
                    </div>
                </div>
            </div>
            
            <div class="module filter-module">
                <div class="module-header">
                    <h3 class="module-title">
                        <i class="fas fa-filter"></i>
                        Filter
                    </h3>
                </div>
                <div class="control-group">
                    <!-- Added filter type toggle -->
                    <div class="toggle-container">
                        <label class="toggle-label">Filter Type</label>
                        <label class="toggle-switch">
                            <input type="checkbox" id="filterTypeToggle">
                            <span class="toggle-slider"></span>
                        </label>
                        <div class="toggle-state" id="filterTypeState">LP</div>
                    </div>
                </div>
                <div class="control-group">
                    <div class="knob-container">
                        <label class="knob-label">Cutoff</label>
                        <div class="knob" id="filterCutoffKnob">
                            <div class="knob-inner"></div>
                            <div class="tooltip">Adjust filter cutoff frequency</div>
                        </div>
                        <input type="range" id="filterCutoff" min="20" max="20000" value="2000">
                        <span class="knob-value" id="filterCutoffValue">2000 Hz</span>
                        
                        <!-- Add fine control slider for low frequencies -->
                        <div class="fine-control-container">
                            <input type="range" id="filterCutoffLow" min="20" max="1000" value="200" class="fine-control-slider">
                            <span class="fine-control-label">Low-End Focus</span>
                        </div>
                    </div>
                    <div class="knob-container">
                        <label class="knob-label">Resonance</label>
                        <div class="knob" id="filterResKnob">
                            <div class="knob-inner"></div>
                            <div class="tooltip">Adjust filter resonance</div>
                        </div>
                        <input type="range" id="filterRes" min="0" max="20" value="1">
                        <span class="knob-value" id="filterResValue">1</span>
                        </div>
                    </div>
                    
                    <!-- Add Filter Response Curve -->
                    <div class="filter-response">
                        <svg id="filterResponseSvg" width="100%" height="100%">
                            <defs>
                                <linearGradient id="filterGradient" x1="0%" y1="0%" x2="0%" y2="100%">
                                    <stop offset="0%" stop-color="rgba(0, 229, 255, 0.3)" />
                                    <stop offset="100%" stop-color="rgba(0, 229, 255, 0)" />
                                </linearGradient>
                            </defs>
                            <path id="filterCurve" class="filter-curve" d="M0,50 L400,50" />
                            <path id="filterArea" class="filter-area" d="M0,70 L400,70 L400,50 L0,50 Z" fill="url(#filterGradient)" />
                        </svg>
                    </div>
                </div>
                
                <div class="module effects-module">
                    <div class="module-header">
                        <h3 class="module-title">
                            <i class="fas fa-magic"></i>
                            Effects
                        </h3>
                    </div>
                        <!-- Reverb group with dotted border -->
                        <div class="effect-group">
                            <div class="effect-group-label">
                                <i class="fas fa-mountain"></i>
                                Reverb
                            </div>
                            <div class="control-group">
                                <div class="knob-container">
                                    <label class="knob-label">Mix</label>
                                    <div class="knob" id="reverbMixKnob">
                                        <div class="knob-inner"></div>
                                        <div class="tooltip">Adjust reverb mix</div>
                                    </div>
                                    <input type="range" id="reverbMix" min="0" max="1" step="0.01" value="0.3">
                                    <span class="knob-value" id="reverbMixValue">0.30</span>
                                </div>
                                <!-- New reverb decay knob -->
                                <div class="knob-container">
                                    <label class="knob-label">Decay</label>
                                    <div class="knob" id="reverbDecayKnob">
                                        <div class="knob-inner"></div>
                                        <div class="tooltip">Adjust reverb decay/tail</div>
                                    </div>
                                    <input type="range" id="reverbDecay" min="0.1" max="10" step="0.1" value="2">
                                    <span class="knob-value" id="reverbDecayValue">2.0s</span>
                                </div>
                            </div>
                        
                        <!-- Delay group with dotted border -->
                        <div class="effect-group">
                            <div class="effect-group-label">
                                <i class="fas fa-clock"></i>
                                Delay
                            </div>
                            <div class="control-group">
                                <div class="knob-container">
                                    <label class="knob-label">Time</label>
                                    <div class="knob" id="delayTimeKnob">
                                        <div class="knob-inner"></div>
                                        <div class="tooltip">Adjust delay time</div>
                                    </div>
                                    <input type="range" id="delayTime" min="0" max="1" step="0.01" value="0.3">
                                    <span class="knob-value" id="delayTimeValue">0.30</span>
                                </div>
                                <div class="knob-container">
                                    <label class="knob-label">Feedback</label>
                                    <div class="knob" id="delayFeedbackKnob">
                                        <div class="knob-inner"></div>
                                        <div class="tooltip">Adjust delay feedback</div>
                                    </div>
                                    <input type="range" id="delayFeedback" min="0" max="0.9" step="0.01" value="0.4">
                                    <span class="knob-value" id="delayFeedbackValue">0.40</span>
                                </div>
                            </div>
                        </div>
                        
                        <!-- New effects sections -->
                        <div class="effect-group">
                            <div class="effect-group-label">
                                <i class="fas fa-wave-square"></i>
                                Modulation
                            </div>
                            <div class="control-group">
                                <div class="knob-container">
                                    <label class="knob-label">Chorus</label>
                                    <div class="knob" id="chorusMixKnob">
                                        <div class="knob-inner"></div>
                                        <div class="tooltip">Adjust chorus mix</div>
                                    </div>
                                    <input type="range" id="chorusMix" min="0" max="1" step="0.01" value="0">
                                    <span class="knob-value" id="chorusMixValue">0.00</span>
                                </div>
                                <div class="knob-container">
                                    <label class="knob-label">Flanger</label>
                                    <div class="knob" id="flangerMixKnob">
                                        <div class="knob-inner"></div>
                                        <div class="tooltip">Adjust flanger mix</div>
                                    </div>
                                    <input type="range" id="flangerMix" min="0" max="1" step="0.01" value="0">
                                    <span class="knob-value" id="flangerMixValue">0.00</span>
                                </div>
                            </div>
                        </div>
                        
                        <div class="effect-group">
                            <div class="effect-group-label">
                                <i class="fas fa-bolt"></i>
                                Character
                            </div>
                            <div class="control-group">
                                <div class="knob-container">
                                    <label class="knob-label">Distortion</label>
                                    <div class="knob" id="distortionMixKnob">
                                        <div class="knob-inner"></div>
                                        <div class="tooltip">Adjust distortion amount</div>
                                    </div>
                                    <input type="range" id="distortionMix" min="0" max="1" step="0.01" value="0">
                                    <span class="knob-value" id="distortionMixValue">0.00</span>
                                </div>
                                <div class="knob-container">
                                    <label class="knob-label">Phaser</label>
                                    <div class="knob" id="phaserMixKnob">
                                        <div class="knob-inner"></div>
                                        <div class="tooltip">Adjust phaser mix</div>
                                    </div>
                                    <input type="range" id="phaserMix" min="0" max="1" step="0.01" value="0">
                                    <span class="knob-value" id="phaserMixValue">0.00</span>
                                </div>
                            </div>
                        </div>
                    </div>                
                </div>
            </div>
    
            <div class="main-modules-2">
                <div class="module adsr-module">
                    <div class="module-header">
                        <h3 class="module-title">
                            <i class="fas fa-sliders-h"></i>
                            Envelope (ADSR)
                        </h3>
                    </div>
                    <div class="control-group">
                        <div class="knob-container">
                            <label class="knob-label">Attack</label>
                            <div class="knob" id="attackKnob">
                                <div class="knob-inner"></div>
                                <div class="tooltip">Adjust attack time</div>
                            </div>
                            <input type="range" id="attack" min="0" max="12" step="0.01" value="0.1">
                            <span class="knob-value" id="attackValue">0.10s</span>
                        </div>
                        <div class="knob-container">
                            <label class="knob-label">Decay</label>
                            <div class="knob" id="decayKnob">
                                <div class="knob-inner"></div>
                                <div class="tooltip">Adjust decay time</div>
                            </div>
                            <input type="range" id="decay" min="0" max="12" step="0.01" value="0.2">
                            <span class="knob-value" id="decayValue">0.20s</span>
                        </div>
                        <div class="knob-container">
                            <label class="knob-label">Sustain</label>
                            <div class="knob" id="sustainKnob">
                                <div class="knob-inner"></div>
                                <div class="tooltip">Adjust sustain level</div>
                            </div>
                            <input type="range" id="sustain" min="0" max="1" step="0.01" value="0.5">
                            <span class="knob-value" id="sustainValue">0.50</span>
                        </div>
                        <div class="knob-container">
                            <label class="knob-label">Release</label>
                            <div class="knob" id="releaseKnob">
                                <div class="knob-inner"></div>
                                <div class="tooltip">Adjust release time</div>
                            </div>
                            <input type="range" id="release" min="0" max="12" step="0.01" value="0.5">
                            <span class="knob-value" id="releaseValue">0.50s</span>
                        </div>
                    </div>
                    
                    <!-- Add ADSR Envelope Visualizer -->
                    <div class="adsr-visualizer">
                        <svg id="adsrVisualizerSvg" width="100%" height="100%">
                            <path id="adsrPath" class="adsr-path" d="M0,70 L0,70" />
                        </svg>
                        <div id="adsrMarker" class="adsr-marker" style="display: none;"></div>
                    </div>
                </div>
                
                <div class="module eq-module">
                    <div class="module-header">
                        <h3 class="module-title">
                            <i class="fas fa-sliders-h"></i>
                            Equalizer
                        </h3>
                    </div>
                    <div class="control-group">
                        <div class="knob-container">
                            <label class="knob-label">Low</label>
                            <div class="knob" id="eqLowKnob">
                                <div class="knob-inner"></div>
                                <div class="tooltip">Adjust low frequency gain</div>
                            </div>
                            <input type="range" id="eqLow" min="-12" max="12" value="0" step="0.5">
                            <span class="knob-value" id="eqLowValue">0 dB</span>
                        </div>
                        <div class="knob-container">
                            <label class="knob-label">Mid</label>
                            <div class="knob" id="eqMidKnob">
                                <div class="knob-inner"></div>
                                <div class="tooltip">Adjust mid frequency gain</div>
                            </div>
                            <input type="range" id="eqMid" min="-12" max="12" value="0" step="0.5">
                            <span class="knob-value" id="eqMidValue">0 dB</span>
                        </div>
                        <div class="knob-container">
                            <label class="knob-label">High</label>
                            <div class="knob" id="eqHighKnob">
                                <div class="knob-inner"></div>
                                <div class="tooltip">Adjust high frequency gain</div>
                            </div>
                            <input type="range" id="eqHigh" min="-12" max="12" value="0" step="0.5">
                            <span class="knob-value" id="eqHighValue">0 dB</span>
                        </div>
                    </div>
                    <div class="control-group">
                        <div class="knob-container">
                            <label class="knob-label">Mid Freq</label>
                            <div class="knob" id="eqMidFreqKnob">
                                <div class="knob-inner"></div>
                                <div class="tooltip">Adjust mid frequency center</div>
                            </div>
                            <input type="range" id="eqMidFreq" min="200" max="5000" value="1000" step="50">
                            <span class="knob-value" id="eqMidFreqValue">1000 Hz</span>
                        </div>
                        <div class="knob-container">
                            <label class="knob-label">Q</label>
                            <div class="knob" id="eqQKnob">
                                <div class="knob-inner"></div>
                                <div class="tooltip">Adjust Q factor (bandwidth)</div>
                            </div>
                            <input type="range" id="eqQ" min="0.1" max="5" value="1" step="0.1">
                            <span class="knob-value" id="eqQValue">1.0</span>
                        </div>
                    </div>
                    
                    <!-- Improved EQ Response Curve Visualization -->
                    <div class="eq-response">
                        <svg id="eqResponseSvg" width="100%" height="100%">
                            <defs>
                                <linearGradient id="eqGradient" x1="0%" y1="0%" x2="0%" y2="100%">
                                    <stop offset="0%" stop-color="rgba(0, 229, 255, 0.4)" />
                                    <stop offset="50%" stop-color="rgba(157, 70, 255, 0.2)" />
                                    <stop offset="100%" stop-color="rgba(157, 70, 255, 0)" />
                                </linearGradient>
                            </defs>
                            <!-- Grid lines will be added by JS -->
                            <g id="eqGrid"></g>
                            <!-- Zero dB reference line -->
                            <line id="eqZeroLine" class="eq-zero-line" x1="0" y1="50%" x2="100%" y2="50%"></line>
                            <!-- Frequency labels will be added by JS -->
                            <g id="eqLabels"></g>
                            <!-- Mid frequency marker -->
                            <line id="eqMidMarker" class="eq-mid-marker" x1="50%" y1="0" x2="50%" y2="100%"></line>
                            <!-- The EQ curve and area -->
                            <path id="eqArea" class="eq-area" d="M0,50% L100%,50% L100%,50% L0,50% Z" fill="url(#eqGradient)" />
                            <path id="eqCurve" class="eq-curve" d="M0,50% L100%,50%" />
                        </svg>
                    </div>
                </div>
    
                <div class="module drone-module">
                    <div class="module-header">
                        <h3 class="module-title">
                            <i class="fas fa-broadcast-tower"></i>
                            Drone Generator
                        </h3>
                    </div>
                    <div class="control-group">
                        <div class="select-container">
                            <label class="select-label">Drone Type</label>
                            <select id="droneType">
                                <option value="oscillator">Oscillator</option>
                                <option value="white">White Noise</option>
                                <option value="pink">Pink Noise</option>
                            </select>
                        </div>
                        <div class="knob-container">
                            <label class="knob-label">Sub Range</label>
                            <div class="knob" id="droneOctaveKnob">
                                <div class="knob-inner"></div>
                                <div class="tooltip">Adjust drone octave</div>
                            </div>
                            <input type="range" id="droneOctave" min="-3" max="0" step="1" value="-1">
                            <span class="knob-value" id="droneOctaveValue">-1</span>
                        </div>
                        <div class="knob-container">
                            <label class="knob-label">Volume</label>
                            <div class="knob" id="droneVolumeKnob">
                                <div class="knob-inner"></div>
                                <div class="tooltip">Adjust drone volume</div>
                            </div>
                            <input type="range" id="droneVolume" min="0" max="1" step="0.01" value="0.8">
                            <span class="knob-value" id="droneVolumeValue">0.80</span>
                        </div>
                        <button class="drone-button" id="droneButton">
                            <i class="fas fa-power-off"></i>
                            <span>Start Drone</span>
                        </button>
                    </div>
                    <div class="drone-visualizer">
                        <div class="drone-wave" id="droneWave">
                            <span></span>
                            <span></span>
                            <span></span>
                            <span></span>
                            <span></span>
                        </div>
                    </div>
                </div>

                
                <!-- Quick Chord Module -->
                <div class="module quick-chord-module">
                    <div class="module-header">
                        <h3 class="module-title">
                            <i class="fas fa-music"></i>
                            Quick Chord
                        </h3>
                        <!-- Add octave pagination in the header -->
                        <div class="octave-pagination">
                            <button class="octave-page-btn" id="decreaseOctave" title="Lower Octave (Z key)">
                                <i class="fas fa-minus"></i>
                            </button>
                            <span class="octave-page-display" id="currentOctave">C4</span>
                            <button class="octave-page-btn" id="increaseOctave" title="Raise Octave (X key)">
                                <i class="fas fa-plus"></i>
                            </button>
                        </div>
                    </div>
                    <div class="chord-controls-container">
                        <div class="chord-controls">
                            <div class="button-group-label">Chord Type</div>
                            <div class="chord-buttons">
                                <button class="chord-button" data-chord-type="maj">Maj</button>
                                <button class="chord-button" data-chord-type="min">Min</button>
                                <button class="chord-button" data-chord-type="dim">Dim</button>
                                <button class="chord-button" data-chord-type="aug">Aug</button>
                                <button class="chord-button" data-chord-type="maj7">Maj7</button>
                                <button class="chord-button" data-chord-type="min7">Min7</button>
                                <button class="chord-button" data-chord-type="dom7">Dom7</button>
                                <button class="chord-button" data-chord-type="maj9">Maj9</button>
                            </div>
                            <div class="button-group-label">Root Note</div>
                            <div class="note-buttons">
                                <button class="note-button" data-note="C">C</button>
                                <button class="note-button" data-note="C#">C#</button>
                                <button class="note-button" data-note="D">D</button>
                                <button class="note-button" data-note="D#">D#</button>
                                <button class="note-button" data-note="E">E</button>
                                <button class="note-button" data-note="F">F</button>
                                <button class="note-button" data-note="F#">F#</button>
                                <button class="note-button" data-note="G">G</button>
                                <button class="note-button" data-note="G#">G#</button>
                                <button class="note-button" data-note="A">A</button>
                                <button class="note-button" data-note="A#">A#</button>
                                <button class="note-button" data-note="B">B</button>
                            </div>
                        </div>
                        
                        <!-- Removed the previous octave counter since we now have it in the header -->
                    </div>
                </div>
            </div>
    
            <div class="visualization">
                <div class="module preset-module">
                    <div class="module-header">
                        <h3 class="module-title">
                            <i class="fas fa-bookmark"></i>
                            Presets
                        </h3>
                    </div>
                    <div class="preset-list" id="presetList">
                        <!-- Presets will be generated by JavaScript -->
                    </div>
                    <div class="preset-actions">
                        <button id="newPresetBtn">
                            <i class="fas fa-plus"></i>
                            <span>New</span>
                        </button>
                        <button id="deletePresetBtn">
                            <i class="fas fa-trash-alt"></i>
                            <span>Delete</span>
                        </button>
                    </div>
                </div>
                
                <div class="module lfo-module">
                    <div class="module-header">
                        <h3 class="module-title">
                            <i class="fas fa-sync-alt"></i>
                            LFO
                        </h3>
                    </div>
                    <div class="control-group">
                        <div class="select-container">
                            <label class="select-label">Waveform</label>
                            <select id="lfoWaveform">
                                <option value="sine">Sine</option>
                                <option value="triangle">Triangle</option>
                                <option value="square">Square</option>
                                <option value="sawtooth">Sawtooth</option>
                                <option value="random">Random</option>
                            </select>
                        </div>
                        <div class="select-container">
                            <label class="select-label">Destination</label>
                            <select id="lfoDestination">
                                <!-- LFO Control -->
                                <option value="off" selected>Off</option>
                                
                                <optgroup label="Oscillator">
                                    <option value="oscillatorLevel">Oscillator Level</option>
                                    <option value="detune">Detune</option>
                                </optgroup>
                                
                                <optgroup label="Filter">
                                    <option value="filterCutoff">Filter Cutoff</option>
                                    <option value="filterRes">Filter Resonance</option>
                                </optgroup>
                                
                                <optgroup label="ADSR">
                                    <option value="attack">Attack Time</option>
                                    <option value="decay">Decay Time</option>
                                    <option value="sustain">Sustain Level</option>
                                    <option value="release">Release Time</option>
                                </optgroup>
                                
                                <optgroup label="Time-Based Effects">
                                    <option value="reverbMix">Reverb Mix</option>
                                    <option value="reverbDecay">Reverb Decay</option>
                                    <option value="delayTime">Delay Time</option>
                                    <option value="delayFeedback">Delay Feedback</option>
                                </optgroup>
                                
                                <optgroup label="Modulation Effects">
                                    <option value="chorusMix">Chorus Mix</option>
                                    <option value="flangerMix">Flanger Mix</option>
                                    <option value="phaserMix">Phaser Mix</option>
                                    <option value="distortionMix">Distortion</option>
                                </optgroup>
                                
                                <optgroup label="Master">
                                    <option value="masterVolume">Main Volume</option>
                                    <option value="pan">Stereo Pan</option>
                                    <option value="stereoWidth">Stereo Width</option>
                                </optgroup>
                            </select>
                        </div>
                    </div>
                    <div class="control-group">
                        <div class="knob-container">
                            <label class="knob-label">Rate</label>
                            <div class="knob" id="lfoRateKnob">
                                <div class="knob-inner"></div>
                                <div class="tooltip">Adjust LFO speed</div>
                            </div>
                            <input type="range" id="lfoRate" min="0.01" max="5" step="0.01" value="0.5">
                            <span class="knob-value" id="lfoRateValue">1.0 Hz</span>
                        </div>
                        <div class="knob-container">
                            <label class="knob-label">Amount</label>
                            <div class="knob" id="lfoAmountKnob">
                                <div class="knob-inner"></div>
                                <div class="tooltip">Adjust modulation amount</div>
                            </div>
                            <input type="range" id="lfoAmount" min="0" max="100" value="50">
                            <span class="knob-value" id="lfoAmountValue">50%</span>
                        </div>
                    </div>
                    
                    <!-- Add LFO Scope with clear height -->
                    <div class="lfo-scope">
                        <canvas id="lfoScope" width="100%" height="80"></canvas>
                    </div>
                </div>
                
                <div class="module oscilloscope-module">
                    <div class="module-header">
                        <h3 class="module-title">
                            <i class="fas fa-chart-line"></i>
                            Oscilloscope
                        </h3>
                    </div>
                    <div class="oscilloscope">
                        <div class="oscilloscope-grid"></div>
                        <canvas id="oscilloscope"></canvas>
                    </div>
                    <div class="vu-meter">
                        <div class="vu-meter-fill" id="vuMeter"></div>
                    </div>
                </div>
                
                <!-- Mastering Module -->
                <div class="module mastering-module">
                    <div class="module-header">
                        <h3 class="module-title">
                            <i class="fas fa-sliders-h"></i>
                            Mastering
                        </h3>
                    </div>
                    <div class="compact-controls">
                        <div class="small-knob-container">
                            <label class="knob-label">Volume</label>
                            <div class="small-knob" id="masterVolumeKnob">
                                <div class="small-knob-inner"></div>
                            </div>
                            <input type="range" id="masterVolume" min="0" max="2" step="0.01" value="0.8">
                            <span class="knob-value" id="masterVolumeValue">0.80</span>
                        </div>
                        <div class="small-knob-container">
                            <label class="knob-label">Pan</label>
                            <div class="small-knob" id="masterPanKnob">
                                <div class="small-knob-inner"></div>
                            </div>
                            <input type="range" id="masterPan" min="-1" max="1" step="0.01" value="0">
                            <span class="knob-value" id="masterPanValue">C</span>
                        </div>
                        <div class="small-knob-container">
                            <label class="knob-label">Width</label>
                            <div class="small-knob" id="stereoWidthKnob">
                                <div class="small-knob-inner"></div>
                            </div>
                            <input type="range" id="stereoWidth" min="0" max="1" step="0.01" value="0.5">
                            <span class="knob-value" id="stereoWidthValue">0.50</span>
                        </div>
                        <div class="small-knob-container">
                            <label class="knob-label">Comp</label>
                            <div class="small-knob" id="compressorKnob">
                                <div class="small-knob-inner"></div>
                            </div>
                            <input type="range" id="compressor" min="0" max="1" step="0.01" value="0">
                            <span class="knob-value" id="compressorValue">0.00</span>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="module sequencer-container">
                <div class="module-header">
                    <h3 class="module-title">
                        <i class="fas fa-step-forward"></i>
                        Sequencer
    
                        <button class="master-button" id="startSequencer">
                            <i class="fas fa-play"></i>
                            <span>Start</span>
                        </button>
            
                    </h3>
                </div>
                <div class="sequencer" id="sequencer">
                    <!-- Steps will be generated by JavaScript -->
                </div>
                <div class="keyboard" id="keyboard">
                    <!-- Keys will be generated by JavaScript -->
                </div>
            </div>
    
            <!-- New Drum Loop Module -->
            <div class="module drum-loop-module">
                <div class="module-header">
                    <h3 class="module-title">
                        <i class="fas fa-drum"></i>
                        Drum Loop
                        
                        <button class="master-button" id="startDrumLoop">
                            <i class="fas fa-play"></i>
                            <span>Start</span>
                        </button>
                    </h3>
                </div>
                <div class="drum-grid">
                    <!-- Kick Drum Row -->
                    <div class="drum-row" data-drum="kick">
                        <div class="drum-label-container">
                            <div class="drum-label">Kick</div>
                            <div class="drum-volume-control">
                                <div class="drum-volume-knob" id="kickVolumeKnob">
                                    <div class="drum-volume-knob-inner"></div>
                                </div>
                                <input type="range" id="kickVolume" class="drum-volume-range" min="0" max="1" step="0.01" value="0.8">
                                <span class="drum-volume-value" id="kickVolumeValue">0.80</span>
                            </div>
                        </div>
                        <div class="drum-steps" id="kickSteps">
                            <!-- 16 step buttons will be generated by JavaScript -->
                        </div>
                    </div>
                    
                    <!-- Snare Drum Row -->
                    <div class="drum-row" data-drum="snare">
                        <div class="drum-label-container">
                            <div class="drum-label">Snare</div>
                            <div class="drum-volume-control">
                                <div class="drum-volume-knob" id="snareVolumeKnob">
                                    <div class="drum-volume-knob-inner"></div>
                                </div>
                                <input type="range" id="snareVolume" class="drum-volume-range" min="0" max="1" step="0.01" value="0.7">
                                <span class="drum-volume-value" id="snareVolumeValue">0.70</span>
                            </div>
                        </div>
                        <div class="drum-steps" id="snareSteps">
                            <!-- 16 step buttons will be generated by JavaScript -->
                        </div>
                    </div>
                    
                    <!-- Hi-hat Row -->
                    <div class="drum-row" data-drum="hihat">
                        <div class="drum-label-container">
                            <div class="drum-label">Hi-hat</div>
                            <div class="drum-volume-control">
                                <div class="drum-volume-knob" id="hihatVolumeKnob">
                                    <div class="drum-volume-knob-inner"></div>
                                </div>
                                <input type="range" id="hihatVolume" class="drum-volume-range" min="0" max="1" step="0.01" value="0.6">
                                <span class="drum-volume-value" id="hihatVolumeValue">0.60</span>
                            </div>
                        </div>
                        <div class="drum-steps" id="hihatSteps">
                            <!-- 16 step buttons will be generated by JavaScript -->
                        </div>
                    </div>
                    
                    <!-- Clap Row -->
                    <div class="drum-row" data-drum="clap">
                        <div class="drum-label-container">
                            <div class="drum-label">Clap</div>
                            <div class="drum-volume-control">
                                <div class="drum-volume-knob" id="clapVolumeKnob">
                                    <div class="drum-volume-knob-inner"></div>
                                </div>
                                <input type="range" id="clapVolume" class="drum-volume-range" min="0" max="1" step="0.01" value="0.65">
                                <span class="drum-volume-value" id="clapVolumeValue">0.65</span>
                            </div>
                        </div>
                        <div class="drum-steps" id="clapSteps">
                            <!-- 16 step buttons will be generated by JavaScript -->
                        </div>
                    </div>
                </div>
            </div>
                
            <div class="advance-visualizer">
                <!-- Toggle for advanced visualizers -->
                <div class="visualizer-toggle" id="visualizerToggle">
                    <i class="fas fa-chevron-down"></i>
                    <span>Show Advanced Visualizations</span>
                </div>
            </div>
        </div>
    
        <!-- Modal for new preset -->
        <div class="modal-overlay" id="presetModal">
            <div class="modal">
                <div class="modal-header">
                    <h3 class="modal-title">Save New Preset</h3>
                </div>
                <div class="modal-body">
                    <label for="presetName">Preset Name</label>
                    <input type="text" id="presetName" class="modal-input" placeholder="Enter a name for your preset">
                    
                    <label for="presetCategory">Category</label>
                    <select id="presetCategory" class="modal-select">
                        <option value="bass">Bass</option>
                        <option value="lead">Lead</option>
                        <option value="pad">Pad</option>
                        <option value="fx">FX</option>
                        <option value="pluck">Pluck</option>
                        <option value="keys">Keys</option>
                        <option value="custom" selected>Custom</option>
                    </select>
                </div>
                <div class="modal-actions">
                    <button class="modal-button cancel" id="cancelPresetBtn">Cancel</button>
                    <button class="modal-button confirm" id="savePresetBtn">Save</button>
                </div>
            </div>
        </div>
    

    <script type="module" src="js/main.js"></script>
</body>
</html>